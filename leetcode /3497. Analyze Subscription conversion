select user_id ,
round(sum(case when activity_type='free_trial' then activity_duration  end )*1.00 /count(case when activity_type='free_trial' then 1 end),2) as trial_avg_duration
,round(sum(case when activity_type='paid' then activity_duration end)*1.00/count(case when activity_type='paid' then 1 end),2) as paid_avg_duration 
from UserActivity 
group by  user_id 
having count(case when activity_type='paid' then 1 end )>0
order by user_id asc 
